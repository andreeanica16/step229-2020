<!DOCTYPE html>
<html>
  <head> 
    <meta charset="UTF-8">
    <title>Dataflow Data Analyser</title>
    <script id="configFile" type="text/javascript" src="config.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="script.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body onload="initBody();">

    <!-- TODO add links to different parts of the page -->
    <!-- Sticky Navigation Bar -->
    <header id="topNavigator">
      <a href="#costAnchor">Cost Analysis and Prediction</a>
      <a href="#jobStatusAnchor">Job Status Analysis</a>
      <a href="#sdkAnchor">SDK Analysis</a>
      <a href="#resourceAnchor">Resource Analysis</a>
      <a href="#locationAnchor">Location Analysis</a>
      <a href="#regionGeochart" id="hiddenLink"hidden>Region Geochart</a>
    </header>
    
    <!--Title -->
    <div id="moduleTitle">
        <img src="images/logo.png">
        <div id="titleText">
          <h1 class="bigger">Dataflow</h1>
          <h1> Service Analyser</h1>
        </div>
    </div>

    <div class="moduleSpace"></div>

    <!-- Input for the Project ID-->
    <form id="projectIDForm">
      <input type="text" id="projectID" placeholder="Enter Project ID" name="projectID" required>
      <input type="button" onclick="updateProjectDatabase()" value = "Fetch">
      <!-- Button visible when there are some permissions missing -->
      <button 
          class="permissionButton" 
          id="showMissingPermision" 
          onmouseover="document.getElementById('permissionDialog').hidden = false;" 
          onmouseout="document.getElementById('permissionDialog').hidden = true;"
          hidden>
      </button>
      <!-- Button visible when all permission are set up -->
      <button 
          class="permissionButton" 
          id="allPermisionsCorrect" 
          onmouseover="document.getElementById('permissionDialog').hidden = false;"
          onmouseout="document.getElementById('permissionDialog').hidden = true;"
          hidden>
      </button> 
    </form>

    <!-- Pops up when the user hover over a button from the permissionButton class -->
    <div id="permissionDialog" hidden></div>

    <div class="moduleSpace"></div>
    <!--
    <div id="dataButtons">
      <button class="button" onclick="updateProjectDatabase()">Fetch Info</button>
      <button class="button" onclick="getJobsFromProject(accessDataflowAPI.projectID)">Show info</button>
    </div> -->

    <!-- Choose what to aggregate the data by -->
    <form id="aggregationForm" action="/get-aggregated-data" method="get">
      <label>Choose a variable to aggregate the data by:</label>
      <input type='radio' value='jobName' name='option' onchange="setUpGraphs()" id='radio1'/>
      <label for='radio1'>Job Prefix</label>
      <input type='radio' value='owner' name='option' onchange="setUpGraphs()" id='radio2'/>
      <label for='radio2'>Owner</label>
      <input type='radio' value='region' name='option' onchange="setUpGraphs()" id='radio3'/>
      <label for='radio3'>Region</label>
      <input type='radio' value='programmingLanguage' name='option' onchange="setUpGraphs()" id='radio4'/>
      <label for='radio4'>Programming Language of SDK</label>
      <input type='radio' value='sdk' name='option' onchange="setUpGraphs()" id='radio5'/>
      <label for='radio5'>SDK</label>
    </form>
    
    <div class="gridContainer" id="container" hidden>
      <!-- Map displaying all regions and how many jobs each region has -->
      <!-- Click on the marker for the job list -->
      <a id="regionGeochart">
      <div id="regionDiv" class="gridElement" style="display: none">
        <h2> Region Geochart </h2>
        <div id="additionalData">Click on the markers to get all the jobs from a region</div>
        <div id="chartDiv"></div>
      </div>

      <!--Total cost of jobs within each aggregation.-->
      <!--Predicted cost of future jobs using moving averages.-->
      <!--<a id="costAnchor">-->
      <a id="costAnchor">
      <div class="gridElement cost">
        <h2 class="costTitle">Cost and Cost Estimation</h2>
        <p class="costSubtitle">Hover over segment for costs. All costs in US$.</p>
        <div class="totalCost" id="totalCost-container"></div>
        <div class="graphButton">
          <button class="button dayOptionButton" id="dailyView" onclick="dailyViewHandler();">Daily Scale</button>
          <button class="button weekOptionButton" id="weeklyView" onclick="weeklyViewHandler();">Weekly Scale</button>
        </div>
        <div class="costPrediction" id="costPrediction-container"></div>
        <div class="averageCost" id="averageCost-container"></div>
      </div>

      <!--Comparison of number of failed jobs within each aggreation etc.-->
      <a id="jobStatusAnchor">
      <div class="gridElement failedJobs">
        <h2 class="failedJobsTitle">Job Status Analysis</h2>
        <p class="failedJobsSubtitle">Hover over segment for total count/ cost. All costs in US$.</p>
        <div class="failedJobsPieChart" id="failedJobs-container"></div>
        <div class="failedJobsCostPieChart" id="failedJobsCost-container"></div>
      </div>
      <!--Comparison of different SDKs being used - e.g. proportion of Java vs Python etc.-->
      <!--Analysis on number of outdated SDKs being used - perhaps list of jobs returned using outdated SDKS?-->
      <a id="sdkAnchor">
      <div class="gridElement sdkAnalysis">
        <h2 class="sdkTitle">SDK Analysis</h2>
        <div id="sdk-Analysis"></div>
      </div>
      <!--Analysis of various resource metrics e.g. vCPU count, memory, SSD/HDD comparison.-->
      <a id="resourceAnchor">
      <div class="gridElement resourceAnalysis">
        <h2 class="resourceTitle">Resource Analysis</h2>
        <p class="resourceSubtitle">Hover over segment for total count. SSD Time and HDD Time is measured in GB hr.</p>
        <div class="vCPUAnalysis" id="vCPU-container"></div>
        <div class="SSDVsHDDTimeAnalysis" id="SSDVsHDDTime-container"></div>
      </div>
    
      <!--Map here showing where the different jobs are being run as a visual representation.-->
      <!--Perhaps basic analysis e.g. region where most are run, region where most fail etc.-->
      <a id="locationAnchor">
      <div class="gridElement locationAnalysis">
        <h2 class="locationTitle">Location Analysis</h2>
        <div id=""></div>
      </div>
    </div>
    <table id = "jobs" hidden>
      <tr> 
        <th> Name </th>
        <th> ID </th>
        <th> Type </th>
        <th> State </th>
        <th> State Time </th>
        <th> SDK </th>
        <th> Region </th>
        <th> Current Workers </th>
        <th> Start Time </th>
        <th> VCPU Time </th>
        <th> Memory Time </th>
        <th> HDD Disk Time </th>
        <th> SSD Disk Time </th>
        <th> VCPU Countr </th>
        <th> Total Streaming Data </th>
        <th> Price </th>
      </tr>
    </table>
  </body>
</html>
